# é¡¹ç›®å¼€å‘æ—¥å¿—ï¼šæŠ€æœ¯å®è·µä¸æˆé•¿ä¹‹è·¯

## å‰è¨€
å›é¡¾è¿™å‡ å¤©çš„çŠ¶æ€ï¼Œçƒ­æƒ…æ€»æ˜¯æ¯”æˆ‘æƒ³è±¡ä¸­æ›´å¿«è¢«æ¶ˆè€—å®Œã€‚æ¯”èµ·èŒ«ç„¶å¾˜å¾Šçš„å°ä¸‘ï¼Œæˆ‘æ›´å¸Œæœ›è‡ªå·±æ˜¯å¯¹ç€é£è½¦å†²é”‹çš„ç–¯å­ã€‚
ä»Šå¤©ç»§ç»­æ·±å…¥é¡¹ç›®çš„å®é™…ä¸šåŠ¡ã€‚
çŠ¶æ€å¥½ç‚¹çš„æ—¶å€™ï¼Œå†çœ‹è‡ªå·±EMOæ—¶å†™çš„ä¸œè¥¿ï¼Œå°¬æ­»æˆ‘äº†ï¼Œä½ çœŸçš„æ˜¯è¦å°¬æ­»æˆ‘ğŸ˜°ã€‚

## æ—¥ç¨‹

### 5.11
é‚£å¤©å¿˜è®°è®°å½•äº†ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰å·æ‡’ã€‚

### 5.12
å†™äº†ä¸€ä¸ªä¸‹åˆï¼Œä¸ç”¨æƒ³å»ºè¡¨ï¼Œä¸ç”¨æƒ³æ¥å£æ–‡æ¡£å°±æ˜¯çˆ½ï¼Œæ˜¨å¤©çš„æˆ‘ï¼Œä½ çš„è‹¦æ²¡æœ‰ç™½åƒï¼åç‚¹åŠï¼ŒæŠŠä¸šåŠ¡éœ€æ±‚å†™å¾—ä¸ƒä¸ƒå…«å…«äº†ï¼Œä¼°è®¡åå¤©å°±èƒ½å¼€å§‹åšå‰ç«¯ã€‚

### 5.13
æˆ‘å°±ä¸è¯¥çœ‹åˆ«äººçš„ä»€ä¹ˆæ„Ÿäººçˆ±æƒ…å°æ•…äº‹ğŸ˜­åªæœ‰å¯¹æ¯”åˆ«äººçš„å¹¸ç¦çš„æ—¶å€™æ‰èƒ½æ·±åˆ»æ„Ÿè§‰åˆ°è‡ªå·±çš„ç ´é˜²ã€‚ï¼ˆè¿˜ä¸çŸ¥é“æŠŠè€³æœºä¸¢å“ªé‡Œäº†ï¼Œéš”å‡ ä¸ªæœˆå°±è¦ä¸ºè“ç‰™è€³æœºè¡Œä¸šåšè´¡çŒ®ğŸ˜«ï¼‰ã€‚è¢«tokenéªŒè¯å¡äº†ï¼Œæƒ³ç”¨AOPï¼Œä½†æ˜¯å®é™…å®ç°èµ·æ¥ç‰¹åˆ«ç‰¹åˆ«éº»çƒ¦ï¼Œå…ˆçœ‹çœ‹èƒ½ä¸èƒ½å¼„å‡ºæ¥å§ã€‚

### 5.16
æœ‰å‡ å¤©æ²¡æœ‰å†™blogäº†ï¼Œæˆ‘è§‰å¾—æ—¥å¸¸æ€§çš„è®°å½•æœ€å¥½è¿˜æ˜¯å†™å†™å§ã€‚ä»Šå¤©å»å½“äº†ä¸€ä¸ªä¼šè®®çš„è§‚ä¼—ï¼Œæˆ‘æœç„¶è¿˜æ˜¯æ™•ä¼šè®®æ¡Œã€‚å‰ç«¯åœ¨å†™äº†ï¼Œåœ¨å†™äº†ï¼Œå¿«çš„è¯æ˜å¤©èƒ½å†™å®Œï¼Œç„¶åå°±æ˜¯ä¿®ä¿®ç•Œé¢ã€‚æœ€å¥½å‘¨æ—¥èƒ½æŠŠDOCKERFILEè·‘å‡ºæ¥ã€‚

### 5.17
emmmmm,æ˜¨æ™šä¸Šåˆç†¬å¤œäº†ï¼Œæœ€è¿‘å¤ªå¤ªå¤ªæ‡’æ•£äº†ã€‚ä¸‹åˆï¼Œå‰ç«¯åŸºæœ¬è·‘å®Œï¼Œç„¶åè¦ä¸€ä¸ªä¸ªå¾®è°ƒäº†ã€‚wcï¼Œæˆ‘å¥½åƒæœ‰ä¸å°‘ä½œä¸šæ²¡å†™å•ŠğŸ˜°ã€‚æ”¹äº†ä¸€æ™šä¸Šï¼Œæ”¹å¾—å·®ä¸å¤šäº†ï¼Œæ˜å¤©æƒ³æƒ³æ•°æ®åŠ å¯†çš„é—®é¢˜ã€‚

### 5.18
å°è¯•äº†ä¸€ä¸‹åšæ•°æ®åŠ å¯†ï¼Œæ„Ÿè§‰å¼€é”€å¾ˆå¤§ï¼Œå¯¹åŸç†ä¹Ÿä¸æ˜¯å¤ªæ˜ç™½ï¼Œå…ˆæŒ‚åˆ°åˆ†æ”¯ï¼ŒæŠŠè¿™ä¸ªç‰ˆæœ¬çš„æœåŠ¡å™¨ç»™éƒ¨ç½²äº†å…ˆã€‚

### 5.19
æ˜¨å¤©çš„éƒ¨ç½²æ²¡æœ‰æˆåŠŸï¼Œä»Šå¤©åˆå¼„äº†ä¸€å¤©ï¼Œæ€»ç®—æˆåŠŸäº†ï¼Œè¿˜æ˜¯æœ‰ç‚¹å°æˆå°±æ„Ÿçš„ã€‚ä½†æ˜¯é”™è¿‡äº†å­¦ç§‘ä½œä¸šï¼Œè¿˜ä¸èƒ½è¡¥äº¤ï¼Œæ‹–å»¶ç—‡å‘åŠ›äº†ã€‚è­¦é’Ÿé•¿é¸£ï¼šèƒ½åŠæ—¶å®Œæˆçš„äº‹æƒ…è¦åŠæ—¶å®Œæˆï¼ˆæŒ‡å†™blogï¼Œä»Šå¤©linuxéƒ¨ç½²dockerçš„éƒ¨åˆ†å°±æ²¡æœ‰è®°åˆ°ï¼‰ã€‚

## å­¦ä¹ å†…å®¹

### çœæµ
1. è¡¨ä¸å®é™…ä¸šåŠ¡çš„åˆ†æ
2. äº‹åŠ¡ä¸­è·å–è‡ªå¢id
3. InvocationTargetException
4. MySQLçš„tinyint(1)ç»†èŠ‚
5. mavençš„èšåˆjaræ‰“åŒ…

### 1. è¡¨ä¸å®é™…ä¸šåŠ¡çš„åˆ†æ
ç»è¿‡æ€è€ƒï¼Œæˆ‘è§‰å¾—ä»¥æ··åˆåˆ’åˆ†æ³•æ¥åˆ’åˆ†æ¥å£æ–‡æ¡£æ¯”è¾ƒåˆç†ã€‚ä»¥ä¸‹æ˜¯å­¦ç”Ÿå’Œæ•™å¸ˆæ¥å£æ–‡æ¡£çš„åˆ’åˆ†ï¼š

#### å­¦ç”Ÿæ¥å£æ–‡æ¡£
- è¯¾ç¨‹ç›¸å…³
  - è·å–è¯¾ç¨‹åˆ—è¡¨
  - è·å–è¯¾ç¨‹è¯¦æƒ…
- ç»ƒä¹ ç›¸å…³
  - è·å–ç»ƒä¹ åˆ—è¡¨
  - è·å–ç»ƒä¹ è¯¦æƒ…
  - æäº¤ç»ƒä¹ ç­”æ¡ˆ
- åšé¢˜ç›¸å…³
  - è·å–é¢˜ç›®è¯¦æƒ…
  - ä¿å­˜ä¸´æ—¶ç­”æ¡ˆ
  - æäº¤æœ€ç»ˆç­”æ¡ˆ

#### æ•™å¸ˆæ¥å£æ–‡æ¡£
- ç»ƒä¹ ç®¡ç†
  - åˆ›å»ºç»ƒä¹ 
  - ä¿®æ”¹ç»ƒä¹ 
  - å¤ç”¨ç»ƒä¹ 
  - åˆ é™¤ç»ƒä¹ 
  - æŸ¥è¯¢ç»ƒä¹ åˆ—è¡¨
- é¢˜ç›®ç®¡ç†
  - æ·»åŠ æ–°é¢˜ç›®
  - ä»é¢˜åº“é€‰æ‹©é¢˜ç›®
  - åˆ é™¤é¢˜ç›®
- æ‰¹æ”¹ç›¸å…³
  - è·å–å¾…æ‰¹æ”¹åˆ—è¡¨
  - è·å–å­¦ç”Ÿç­”é¢˜è¯¦æƒ…
  - æäº¤æ‰¹æ”¹ç»“æœ
  - å‘é€æé†’é€šçŸ¥

æ‰€ä»¥æŒ‰ç…§è¿™æ ·çš„åˆ’åˆ†æ¥ä¹¦å†™æ¥å£æ–‡æ¡£ã€‚

#### æŸ¥è¯¢æ‰€å±çš„è¯¾ç¨‹
å­¦ç”Ÿ -> å­¦ç”Ÿç­çº§å…³è” -> ç­çº§ -> ç»ƒä¹ ç­çº§å…³è” -> ç»ƒä¹  -> è¯¾ç¨‹ã€‚è¿™æ ·çœ‹èµ·æ¥æ˜¯ä¸æ˜¯ç‰¹åˆ«éº»çƒ¦ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”Ÿæˆè§†å›¾ï¼è§†å›¾æ˜¯æ•°æ®åº“ä¸­çš„ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œä¸å­˜å‚¨å®é™…æ•°æ®ï¼Œå®é™…æ˜¯ä¸€ä¸ªé¢„å®šä¹‰çš„æŸ¥è¯¢ã€‚

æ¯”å¦‚åˆ›å»ºå­¦ç”Ÿè¯¾ç¨‹è§†å›¾ï¼š
```sql
CREATE VIEW v_student_courses AS
SELECT 
    u.id AS student_id,
    u.name AS student_name,
    c.id AS course_id,
    c.name AS course_name,
    s.id AS semester_id,
    s.name AS semester_name,
    s.start_time AS semester_start,
    s.end_time AS semester_end,
    COUNT(DISTINCT e.id) AS exercise_count
FROM 
    user u
JOIN 
    student_class sc ON u.id = sc.student_id
JOIN 
    exercise_class ec ON sc.class_id = ec.class_id
JOIN 
    exercise e ON ec.exercise_id = e.id
JOIN 
    course c ON e.course_id = c.id
JOIN 
    semester s ON c.semester_id = s.id
WHERE 
    u.role = 0  -- å­¦ç”Ÿè§’è‰²
GROUP BY 
    u.id, c.id, s.id;
```

ç„¶åå°±å¯ä»¥é€šè¿‡å¯¹è§†å›¾è¿›è¡ŒæŸ¥è¯¢ï¼š
```sql
-- æŸ¥è¯¢æŸå­¦ç”Ÿçš„æ‰€æœ‰è¯¾ç¨‹
SELECT * FROM v_student_courses WHERE student_id = 123;
```

### 2. äº‹åŠ¡ä¸­è·å–è‡ªå¢id
æˆ‘ä¹‹å‰ä»¥ä¸ºå¯¹äº‹åŠ¡å­˜åœ¨ä¸€å®šçš„è¯¯è§£ï¼Œè®¤ä¸ºäº‹åŠ¡æ˜¯åŒæ—¶å¤„ç†sqlè¯­å¥ï¼Œå…¶å®ä¸æ˜¯ï¼Œè¿™æ›´åƒæ˜¯å°†æ›´æ”¹ä¿å­˜åœ¨äº†ä¸€ä¸ªç¼“å†²åŒºã€‚å¯¹äº**åŒä¸€ä¸ªè¿æ¥**ï¼Œæ˜¯å¯ä»¥è·å–åˆ°ä¸Šä¸€ä¸ªæ’å…¥æ“ä½œäº§ç”Ÿçš„è‡ªå¢idçš„ï¼ˆå°½ç®¡å®ƒè¿˜æ²¡æœ‰å®é™…æ’å…¥è¡¨ä¸­ï¼‰ã€‚

```java
public static Integer getLastInsertId() throws SQLException, FileNotFoundException {
    Connection conn = getConnection();
    boolean isTxActive = ConnectionContext.isActive();
    try (Statement stmt = conn.createStatement()){
        ResultSet rs = stmt.executeQuery("SELECT LAST_INSERT_ID()");
        if (rs.next()) {
            return rs.getInt(1);
        }
    }catch (SQLException e){
        throw new SQLException("æ— æ³•è·å–æœ€åæ’å…¥ID");
    }finally {
        if (conn != null && !isTxActive) {
            conn.close();
        }
    }
    return null;
}
```

### 3. InvocationTargetException
`InvocationTargetException`æ˜¯åå°„è°ƒç”¨æ—¶çš„â€œåŒ…è£…å¼‚å¸¸â€ã€‚åœ¨é€šè¿‡åå°„è°ƒç”¨æ–¹æ³•æ—¶ï¼Œç›®æ ‡æ–¹æ³•å†…éƒ¨æŠ›å‡ºäº†å¼‚å¸¸ï¼Œåå°„æœºåˆ¶ä¼šå°†è¿™ä¸ªå¼‚å¸¸å°è£…æˆ`InvocationTargetException`æŠ›å‡ºã€‚

```java
private Throwable extractRootCause(Throwable e) {
    Throwable rootCause = e;
    while (rootCause instanceof InvocationTargetException && rootCause.getCause() != null) {
        rootCause = rootCause.getCause();
    }
    return rootCause;
}
```

### 4. MySQLçš„tinyint(1)ç»†èŠ‚
MySQL é©±åŠ¨ï¼ˆå¦‚ mysql-connector-javaï¼‰ä¼šå°† tinyint(1) è‡ªåŠ¨æ˜ å°„ä¸º Booleanã€‚è¿™æ˜¯ JDBC çš„é»˜è®¤è¡Œä¸ºï¼Œtinyint(1) è¢«è¯†åˆ«ä¸ºâ€œç±»ä¼¼å¸ƒå°”å€¼â€çš„ç±»å‹ï¼ˆ0 â†’ falseï¼Œé 0 â†’ trueï¼‰ã€‚

### 5. mavençš„èšåˆjaræ‰“åŒ…
é…ç½®`maven-shade-plugin`æ’ä»¶ï¼Œå°†é¡¹ç›®åŠå…¶æ‰€æœ‰ä¾èµ–æ‰“åŒ…æˆä¸€ä¸ªå•ç‹¬çš„JARæ–‡ä»¶ã€‚

```xml
<build>
    <resources> <!-- èµ„æºæ–‡ä»¶  é»˜è®¤å¤åˆ¶åˆ°target/classes -->
        <resource>
            <directory>src/main/resources</directory> 
        </resource>
        <resource>
            <directory>src/main/webapp</directory>
            <targetPath>webapp</targetPath> <!-- æŒ‡å®šå¤åˆ¶åˆ°webapp -->
        </resource>
    </resources>

    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <version>3.2.4</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>shade</goal> <!-- æ‰“åŒ…æ‰€æœ‰ä¾èµ– -->
                    </goals>
                    <configuration>
                        <transformers> <!-- è®¾ç½® JAR æ–‡ä»¶çš„å…¥å£ -->
                            <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                                <mainClass>com.anyview.xiazihao.TomcatApplication</mainClass>
                            </transformer>
                        </transformers>
                        <filters> <!-- è¿‡æ»¤ç­¾å -->
                            <filter>
                                <artifact>*:*</artifact>
                                <excludes>
                                    <exclude>META-INF/*.SF</exclude>
                                    <exclude>META-INF/*.DSA</exclude>
                                    <exclude>META-INF/*.RSA</exclude>
                                </excludes>
                            </filter>
                        </filters>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

## ç»“è¯­
è¿™æ˜¯ä¸€ä¸ªæ—¶é—´è·¨åº¦éå¸¸é•¿çš„blogï¼ˆå·²ç»ç®—æ˜¯åŠä¸ªæ—¥è®°äº†ï¼‰ã€‚ä»¥åå°±ç®—æ²¡æœ‰å®é™…å†…å®¹ï¼Œä¹Ÿå°½é‡ä¿æŒè¿™ç§å½¢å¼çš„æ›´æ–°å§ã€‚